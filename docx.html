<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Infos de connexion avanc√©es</title>
<style>
  body {
    margin:0; padding:0;
    background: black;
    color: white;
    font-weight: bold;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
    user-select: none;
  }
  #info-list {
    font-size: 1.5rem;
    line-height: 2rem;
    text-align: center;
    max-width: 90vw;
  }
  .pop {
    animation: popAnim 0.3s ease forwards;
  }
  @keyframes popAnim {
    0% {
      transform: scale(1);
      opacity: 0;
    }
    50% {
      transform: scale(1.5);
      opacity: 1;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
    #start-btn {
  background: white;
  color: black;
  font-size: 1.5rem;
  font-weight: bold;
  padding: 1rem 2rem;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  margin-top: 20px;
}

  }
</style>
</head>
<body>
  <button id="start-btn">Lancer</button>
  <div id="info-list"></div>

  <audio id="sound" src="tkt.mp3" preload="auto"></audio>

<script>
function delay(ms) {
  return new Promise(res => setTimeout(res, ms));
}

function getWebGLRenderer() {
  try {
    const canvas = document.createElement('canvas');
    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
    if (!gl) return "non disponible";
    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
    if (debugInfo) {
      return gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
    }
    return "non disponible";
  } catch {
    return "non disponible";
  }
}

function getBrowserPermissions() {
  if (!navigator.permissions) return Promise.resolve({});
  const perms = ['geolocation','notifications','camera','microphone','clipboard-read','clipboard-write','push'];
  const promises = perms.map(name =>
    navigator.permissions.query({name}).then(res => [name, res.state]).catch(() => [name, "inconnu"])
  );
  return Promise.all(promises).then(results => Object.fromEntries(results));
}

async function getBatteryInfo() {
  if (!navigator.getBattery) return {level:"inconnu", charging:"inconnu"};
  try {
    const bat = await navigator.getBattery();
    return {
      level: Math.round(bat.level * 100) + "%",
      charging: bat.charging ? "oui" : "non"
    };
  } catch {
    return {level:"inconnu", charging:"inconnu"};
  }
}

async function getClientIP() {
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    return data.ip;
  } catch {
    return "non disponible";
  }
}

async function getGeoInfo(ip) {
  if (ip === "non disponible") return {country: "-", region: "-", city: "-", isp: "-"};
  try {
    const res = await fetch(`https://ipwhois.app/json/${ip}`);
    const data = await res.json();
    if(data.success === false) return {country: "-", region: "-", city: "-", isp: "-"};
    return {
      country: data.country || "-",
      region: data.region || "-",
      city: data.city || "-",
      isp: data.org || data.isp || "-"
    };
  } catch {
    return {country: "-", region: "-", city: "-", isp: "-"};
  }
}

async function main() {
  const infoListDiv = document.getElementById('info-list');
  const sound = document.getElementById('sound');

  // Joue le son d√®s que possible
  sound.play().catch(e => {
    // auto-play peut √™tre bloqu√©, on pourra g√©rer ici
    console.log("Lecture automatique bloqu√©e ou erreur audio:", e);
  });

  const ip = await getClientIP();
  const geo = await getGeoInfo(ip);
  const battery = await getBatteryInfo();
  const perms = await getBrowserPermissions();

  const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {};
  const memoryUsedMB = performance.memory ? (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(2) : "non disponible";

  const infos = [
    `üåê IP publique : ${ip}`,
    `üåé Pays : ${geo.country}`,
    `üèûÔ∏è R√©gion : ${geo.region}`,
    `üèôÔ∏è Ville : ${geo.city}`,
    `üì° Fournisseur (ISP) : ${geo.isp}`,
    `üß≠ Navigateur (User Agent) : ${navigator.userAgent}`,
    `üñ•Ô∏è Plateforme : ${navigator.platform}`,
    `üó£Ô∏è Langue principale : ${navigator.language}`,
    `üåê Langues pr√©f√©r√©es : ${navigator.languages ? navigator.languages.join(', ') : navigator.language}`,
    `üç™ Cookies activ√©s : ${navigator.cookieEnabled ? "oui" : "non"}`,
    `üö´ Do Not Track : ${navigator.doNotTrack || navigator.msDoNotTrack || window.doNotTrack || "non d√©fini"}`,
    `üñºÔ∏è R√©solution √©cran : ${window.screen.width} x ${window.screen.height}`,
    `üé® Profondeur couleur : ${window.screen.colorDepth} bits`,
    `üì± Pixel Ratio : ${window.devicePixelRatio}`,
    `üß† CPU Cores : ${navigator.hardwareConcurrency || "non disponible"}`,
    `üíæ RAM approximative : ${navigator.deviceMemory ? navigator.deviceMemory + " Go" : "non disponible"}`,
    `üïí Fuseau horaire : ${Intl.DateTimeFormat().resolvedOptions().timeZone || "non disponible"}`,
    `üåô Mode sombre pr√©f√©r√© : ${window.matchMedia('(prefers-color-scheme: dark)').matches ? "oui" : "non"}`,
    `üì∂ En ligne : ${navigator.onLine ? "oui" : "non"}`,
    `ü§è Support tactile : ${('ontouchstart' in window) ? "oui" : "non"}`,
    `üéÆ GPU (WebGL Renderer) : ${getWebGLRenderer()}`,
    `‚è∞ Heure locale : ${new Date().toLocaleTimeString()}`,
    `üìÖ Date compl√®te : ${new Date().toLocaleString()}`,
    `üì∂ Type de connexion : ${connection.effectiveType || "non disponible"}`,
    `‚¨áÔ∏è D√©bit descendant : ${connection.downlink ? connection.downlink + " Mbps" : "non disponible"}`,
    `‚è≥ Latence RTT : ${connection.rtt ? connection.rtt + " ms" : "non disponible"}`,
    `üíæ Mode √©conomie de donn√©es : ${connection.saveData ? "oui" : "non"}`,
    `üîã Niveau batterie : ${battery.level}`,
    `‚ö° Batterie en charge : ${battery.charging}`,
    `üßπ M√©moire JS utilis√©e : ${memoryUsedMB} MB`,
    `üîê Permissions notifications : ${perms.notifications || "inconnu"}`,
    `üåç Permissions g√©olocalisation : ${perms.geolocation || "inconnu"}`,
    `üì∏ Permissions cam√©ra : ${perms.camera || "inconnu"}`,
    `üé§ Permissions micro : ${perms.microphone || "inconnu"}`,
    `üìã Permissions lecture presse-papiers : ${perms["clipboard-read"] || "inconnu"}`,
    `üìã Permissions √©criture presse-papiers : ${perms["clipboard-write"] || "inconnu"}`,
    `üîî Permissions push : ${perms.push || "inconnu"}`,
    `üïπÔ∏è Fullscreen support : ${document.fullscreenEnabled ? "oui" : "non"}`,
    `üß© Cookies SameSite strict support : ${navigator.cookieEnabled ? "probablement oui" : "non"}`,
    `üñ±Ô∏è Souris d√©tect√©e : ${window.matchMedia('(pointer:fine)').matches ? "oui" : "non"}`,
    `üì± Pointeur tactile d√©tect√© : ${window.matchMedia('(pointer:coarse)').matches ? "oui" : "non"}`,
    `üåê Service Worker support : ${'serviceWorker' in navigator ? "oui" : "non"}`,
    `üßÆ Threads Worker support : ${window.Worker ? "oui" : "non"}`,
    `üìÄ Local Storage support : ${'localStorage' in window ? "oui" : "non"}`,
    `üóÉÔ∏è Session Storage support : ${'sessionStorage' in window ? "oui" : "non"}`,
    `üîå Web USB support : ${'usb' in navigator ? "oui" : "non"}`,
    `üîä AudioContext support : ${window.AudioContext || window.webkitAudioContext ? "oui" : "non"}`,
    `üìπ MediaDevices API support : ${navigator.mediaDevices ? "oui" : "non"}`,
    `üåç Online Status API : ${navigator.onLine ? "en ligne" : "hors ligne"}`,
    `üîß User Agent Client Hints support : ${navigator.userAgentData ? "oui" : "non"}`,
    `üß± Cookies enabled : ${navigator.cookieEnabled ? "oui" : "non"}`,
    `üóÇÔ∏è IndexedDB support : ${window.indexedDB ? "oui" : "non"}`,
    `üîÑ Navigator Share support : ${navigator.share ? "oui" : "non"}`,
    `üñ•Ô∏è Max touch points : ${navigator.maxTouchPoints || 0}`,
    `üõ°Ô∏è Web Authentication API support : ${window.PublicKeyCredential ? "oui" : "non"}`,
    `üó£Ô∏è Speech Synthesis support : ${window.speechSynthesis ? "oui" : "non"}`,
    `üìß SMTP support (via JS) : non applicable`,
  ];

  for (const info of infos) {
    await delay(400); // attend 0.4s entre chaque ajout pour effet dynamique
    const p = document.createElement('p');
    p.textContent = info;
    infoListDiv.appendChild(p);

    // ajout effet "pop"
    p.classList.add('pop');
    p.addEventListener('animationend', () => p.classList.remove('pop'));
  }
}

document.getElementById("start-btn").addEventListener("click", () => {
  document.getElementById("start-btn").style.display = "none";
  document.getElementById("sound").play().catch(e => console.warn("Audio bloqu√© :", e));
  main(); // d√©marre l‚Äôaffichage des infos
});

</script>
</body>
</html>
